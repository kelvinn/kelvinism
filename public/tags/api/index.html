<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>Api | Kelvin Nicholson</title>
<meta name="keywords" content="">
<meta name="description" content="">
<meta name="author" content="">
<link rel="canonical" href="http://localhost:1313/tags/api/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.e5d5fdc18d3ba93e96e9e0174d23fd3f2b9076ee85fb125cc29d561cc8955db8.css" integrity="sha256-5dX9wY07qT6W6eAXTSP9PyuQdu6F&#43;xJcwp1WHMiVXbg=" rel="preload stylesheet" as="style"><script src='/js/syntaxhighlighter.js' type='text/javascript'></script>
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" type="application/rss+xml" href="http://localhost:1313/tags/api/index.xml">
<link rel="alternate" hreflang="en" href="http://localhost:1313/tags/api/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
</head>

<body class="list" id="top">
<div id='redbar'></div>
<div id='greenbar'></div>

<div class="container">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>




<header class="header">
    <a href='/'><span id='logo'></span></a>
    <ul>
        <li><a href='/tags/travel/'>Travel</a></li>
        <li><a href='/tags/longevity/'>Longevity</a></li>
        <li><a href='/tags/projects/'>Projects</a></li>
        <li><a href='/tags/howtos/'>Tutorials</a></li>
        <li><a href='/about/'>Who</a></li>
    </ul>

</header><main class="main"> 

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="post-title entry-hint-parent">
      
      <a aria-label="post link to Alexa Thumbnail Service" href="http://localhost:1313/2008/12/alexa-thumbnail-service_3160.html">Alexa Thumbnail Service </a>
      
      
    </h2>

    <div class="post-meta"><span title='2008-12-28 21:30:00.004 +1100 AEDT'>Published on December 28, 2008</span>&nbsp;·&nbsp;1 min

</div>
  </header>

  <div class="entry-content">
    <p>Amazon offers some pretty cool services: S3, EC2, Alexa Site Thumbnail, and others. A while back I wanted to use <a href="http://aws.amazon.com/ast/">AST</a> with <a href="http://www.djangoproject.com">Django</a>, so ended up writing the Python bindings to the REST API (they didn&rsquo;t previously exist. I even wrote up a quick <a href="http://www.kelvinism.com/howtos/alexa-site-thumbnail-and-django/">tutorial</a>.</p>
<p><strong>Update</strong>: Amazon no longer maintains AST. I&rsquo;ve decided to <a href="http://www.kelvinism.com/tech-blog/rip-old-sites/">archive</a> a few of the old sites, so no longer need to take thumbnails. However, a few other thumbnail services seem to have crept up, including <a href="http://snapcasa.com/">SnapCasa&quot;</a>, and <a href="http://www.websnapr.com/">WebSnapr</a>.</p>

  </div>

  
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="post-title entry-hint-parent">
      
      <a aria-label="post link to The Risk in Risk Mitigation" href="http://localhost:1313/2007/03/the-risk-in-risk-mitigation_5540.html">The Risk in Risk Mitigation </a>
      
      
    </h2>

    <div class="post-meta"><span title='2007-03-15 21:30:00.007 +1100 AEDT'>Published on March 15, 2007</span>&nbsp;·&nbsp;2 min

</div>
  </header>

  <div class="entry-content">
    <p><em>Back in the day</em> the barrier to entry for the Internet was quite high. The technology used required a steep learning curve, the equipment extremely expensive, and sometimes even hard to acquire. Fast forward to 2007 and things have certainly changed. If you know any tech people you can likely get free hosting for a small website, and even more demanding websites can be hosted <a href="http://www.vpslink.com/vps-hosting/">for not much</a>. The cost of dedicated servers has dropped even more. And the final kicker: web services. I&rsquo;ve started to think of some web services not as a service, but more like outsourcing requirements.</p>
<p>This very dependency adds risk for a multitude of reasons, and when your entire web application platform revolves around a third party, such as is the case with mashups, you incur great risk.</p>
<p>One of the nice things when requirements are outsourced is the fact that risk is mitigated. I&rsquo;ll use <a href="http://www.smugmug.com/">SmugMug</a> as an <a href="http://blogs.smugmug.com/onethumb/2006/08/12/amazon-s3-the-holy-grail/">example</a>. In summary, they moved their storage to Amason&rsquo;s S3 network, which is something I will be utilizing as well. Amazon&rsquo;s S3 (and other web services) continue to drive down the barrier of entry &ndash; now you don&rsquo;t even need to purchase hugely expensive servers for the sole purchase of storage! If you don&rsquo;t need to purchase them, you also don&rsquo;t need to manage them. Risk mitigated.</p>
<p>However, continuing the slight allusion from The Other Blog&rsquo;s article on <a href="http://www.theotherblog.com/Articles/2007/03/14/what-are-mashups-for-anyway/">mashups</a>, I see a slight problem with the outsourcing of requirements. While the following thought isn&rsquo;t particularly innovative: mitigating risk and outsourcing requirements creates a dependency on the third-party. This very dependency adds risk for a multitude of reasons, and when your entire web application platform revolves around a third party, such as is the case with mashups, you incur great risk.</p>
<p>But, as is evident by the fact that I&rsquo;ve had stitches nine different times, I&rsquo;m still going to do some <a href="http://www.kelvinism.com/projects/mba-funding/">cool mashups</a> anyways, so stay tuned.</p>

  </div>

  
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="post-title entry-hint-parent">
      
      <a aria-label="post link to Python, AST and SOAP" href="http://localhost:1313/2007/03/python-ast-and-soap_3058.html">Python, AST and SOAP </a>
      
      
    </h2>

    <div class="post-meta"><span title='2007-03-07 21:30:00.002 +1100 AEDT'>Published on March 7, 2007</span>&nbsp;·&nbsp;2 min

</div>
  </header>

  <div class="entry-content">
    <p>For one of my projects I need to generate thumbnails for a page. And lots and lots and lots of them. Even though I can generate them via a python script and a very light &ldquo;gtk browser&rdquo;, I would prefer to mitigate the server load. To do this I&rsquo;ve decided to tap into the Alexa Thumbnail Service. They allow two methods: REST and SOAP. After several hours of testing things out, I&rsquo;ve decided to toss in the towel and settle on REST. If you can spot the error with my SOAP setup, I owe you a beer.<br>
I&rsquo;m using the ZSI module for python.</p>
<h4 id="1-wsdl2py">1. wsdl2py</h4>
<p>I pull in the needed classes by using wsdl2py.</p>
<pre tabindex="0"><code>wsdl2py -b http://ast.amazonaws.com/doc/2006-05-15/AlexaSiteThumbnail.wsdl
</code></pre><h4 id="2-look-at-the-code-generated">2. Look at the code generated.</h4>
<p>See <a href="http://www.kelvinism.com/media/types.html">AlexaSiteThumbnail_types.py</a> and <a href="http://www.kelvinism.com/media/client.html">AlexaSiteThumbnail_client.py</a>.</p>
<h4 id="3-write-python-code-to-access-ast-over-soap">3. Write python code to access AST over SOAP.</h4>
<pre tabindex="0"><code>
#!/usr/bin/env python
import sys
import datetime
import hmac
import sha
import base64
from AlexaSiteThumbnail\_client import \*

print &#39;Starting...&#39;

AWS\_ACCESS\_KEY\_ID = &#39;super-duper-access-key&#39;
AWS\_SECRET\_ACCESS\_KEY = &#39;super-secret-key&#39;

print &#39;Generating signature...&#39;

def generate\_timestamp(dtime):
    return dtime.strftime(&#34;%Y-%m-%dT%H:%M:%SZ&#34;)

def generate\_signature(operation, timestamp, secret\_access\_key):
    my\_sha\_hmac = hmac.new(secret\_access\_key, operation + timestamp, sha)
    my\_b64\_hmac\_digest = base64.encodestring(my\_sha\_hmac.digest()).strip()
    return my\_b64\_hmac\_digest

timestamp\_datetime = datetime.datetime.utcnow()
timestamp\_list = list(timestamp\_datetime.timetuple())
timestamp\_list\[6\] = 0
timestamp\_tuple = tuple(timestamp\_list)
timestamp\_str = generate\_timestamp(timestamp\_datetime)

signature = generate\_signature(&#39;Thumbnail&#39;, timestamp\_str, AWS\_SECRET\_ACCESS\_KEY)

print &#39;Initializing Locator...&#39;

locator = AlexaSiteThumbnailLocator()
port = locator.getAlexaSiteThumbnailPort(tracefile=sys.stdout)

print &#39;Requesting thumbnails...&#39;

request = ThumbnailRequestMsg()
request.Url = &#34;alexa.com&#34;
request.Signature = signature
request.Timestamp = timestamp\_tuple
request.AWSAccessKeyId = AWS\_ACCESS\_KEY\_ID
request.Request = \[request.new\_Request()\]

resp = port.Thumbnail(request)
</code></pre><h4 id="4-run-and-see-error">4. Run, and see error.</h4>
<pre tabindex="0"><code>ZSI.EvaluateException: Got None for nillable(False), minOccurs(1) element 
(http://ast.amazonaws.com/doc/2006-05-15/,Url), 

 xmlns:SOAP-ENC=&#34;http://schemas.xmlsoap.org/soap/encoding/&#34; 
xmlns:SOAP-ENV=&#34;http://schemas.xmlsoap.org/soap/envelope/&#34; 
xmlns:ZSI=&#34;http://www.zolera.com/schemas/ZSI/&#34; 
xmlns:ns1=&#34;http://ast.amazonaws.com/doc/2006-05-15/&#34; 
xmlns:xsd=&#34;http://www.w3.org/2001/XMLSchema&#34; 
xmlns:xsi=&#34;http://www.w3.org/2001/XMLSchema-instance&#34;&gt;

\[Element trace: /SOAP-ENV:Body/ns1:ThumbnailRequest\]
</code></pre><h4 id="5-conclusion">5. Conclusion</h4>
<p>I&rsquo;m not entirely certain what I&rsquo;m doing wrong. I&rsquo;ve also written another version but actually with NPBinding connecting to the wsdl file. It seems to work much better, as it fully connects, and I get a 200, but it doesn&rsquo;t return the thumbnail location in the response, and I get a:</p>
<pre tabindex="0"><code>TypeError: Response is &#34;text/plain&#34;, not &#34;text/xml&#34;
</code></pre><p>So, while I have things working fine with REST, I would like to get the SOAP calls working. One beer reward.</p>

  </div>

  
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="post-title entry-hint-parent">
      
      <a aria-label="post link to AWS in Python (REST)" href="http://localhost:1313/2007/03/aws-in-python-rest_5343.html">AWS in Python (REST) </a>
      
      
    </h2>

    <div class="post-meta"><span title='2007-03-03 21:30:00.002 +1100 AEDT'>Published on March 3, 2007</span>&nbsp;·&nbsp;2 min

</div>
  </header>

  <div class="entry-content">
    <p>As some of you may know, I have some projects cooked up. I don&rsquo;t expect to make a million bucks (wish me luck!), but a few extra bills in the pocket wouldn&rsquo;t hurt. Plus, I&rsquo;m highly considering further education, which will set me back a few-thirty grand. That said, one of my projects will rely heavily on <a href="http://www.amazon.com/gp/redirect.html?ie=UTF8&amp;location=http%3A%2F%2Fwww.amazon.com%2FAWS-home-page-Money%2Fb%3Fie%3DUTF8%26node%3D3435361&amp;tag=kelvinismcom-20&amp;linkCode=ur2&amp;camp=1789&amp;creative=9325">Amazon Web Services</a><img loading="lazy" src="http://www.assoc-amazon.com/e/ir?t=kelvinismcom-20&l=ur2&o=1">. Amazon has, for quite some time now, opened up their information via REST and SOAP. I&rsquo;ve been trying (virtually the entire day) to get SOAP to work, but seem to get snagged on a few issues. Stay tuned.<br>
However, in my quest to read every RTFM I stumbled upon a post regarding Python+REST to access <a href="http://www.amazon.com/gp/redirect.html?ie=UTF8&amp;location=http%3A%2F%2Fwww.amazon.com%2Fb%3Fie%3DUTF8%26node%3D269962011%26no%3D239513011%26me%3DA36L942TSJ2AJA&amp;tag=kelvinismcom-20&amp;linkCode=ur2&amp;camp=1789&amp;creative=9325">Alexa Web Search</a><img loading="lazy" src="http://www.assoc-amazon.com/e/ir?t=kelvinismcom-20&l=ur2&o=1">. After staring at Python code, especially trying to grapple why SOAP isn&rsquo;t working, updating the outdated REST code was a 5 minute hack. So, if you are interested in using Alexa Web Search with Python via Rest, look below:</p>
<h4 id="websearchpy">websearch.py</h4>
<pre tabindex="0"><code>
#!/usr/bin/python

&#34;&#34;&#34;
Test script to run a WebSearch query on AWS via the REST interface.  Written
 originally by Walter Korman (shaper@wgks.org), based on urlinfo.pl script from 
  AWIS-provided sample code, updated to the new API by  
Kelvin Nicholson (kelvin@kelvinism.com). Assumes Python 2.4 or greater.
&#34;&#34;&#34;

import base64
import datetime
import hmac
import sha
import sys
import urllib
import urllib2

AWS\_ACCESS\_KEY\_ID = &#39;your-access-key&#39;
AWS\_SECRET\_ACCESS\_KEY = &#39;your-super-secret-key&#39;

def get\_websearch(searchterm):
    def generate\_timestamp(dtime):
        return dtime.strftime(&#34;%Y-%m-%dT%H:%M:%SZ&#34;)
    
    def generate\_signature(operation, timestamp, secret\_access\_key):
        my\_sha\_hmac = hmac.new(secret\_access\_key, operation + timestamp, sha)
        my\_b64\_hmac\_digest = base64.encodestring(my\_sha\_hmac.digest()).strip()
        return my\_b64\_hmac\_digest
    
    timestamp\_datetime = datetime.datetime.utcnow()
    timestamp\_list = list(timestamp\_datetime.timetuple())
    timestamp\_list\[6\] = 0
    timestamp\_tuple = tuple(timestamp\_list)
    timestamp = generate\_timestamp(timestamp\_datetime)
    
    signature = generate\_signature(&#39;WebSearch&#39;, timestamp, AWS\_SECRET\_ACCESS\_KEY)
    
    def generate\_rest\_url (access\_key, secret\_key, query):
        &#34;&#34;&#34;Returns the AWS REST URL to run a web search query on the specified
        query string.&#34;&#34;&#34;
    
        params = urllib.urlencode(
            { &#39;AWSAccessKeyId&#39;:access\_key,
              &#39;Timestamp&#39;:timestamp,
              &#39;Signature&#39;:signature,
              &#39;Action&#39;:&#39;WebSearch&#39;,
              &#39;ResponseGroup&#39;:&#39;Results&#39;,
              &#39;Query&#39;:searchterm, })
        return &#34;http://websearch.amazonaws.com/?%s&#34; % (params)
    
    # print &#34;Querying &#39;%s&#39;...&#34; % (query)
    url = generate\_rest\_url(AWS\_ACCESS\_KEY\_ID, AWS\_SECRET\_ACCESS\_KEY, searchterm)
    # print &#34;url =&gt; %s&#34; % (url)
    print urllib2.urlopen(url).read()
</code></pre><p>You run it like this:</p>
<pre tabindex="0"><code>\&gt;&gt;&gt; from websearch import get\_websearch
&gt;&gt;&gt; get\_websearch(&#39;python&#39;)
</code></pre>
  </div>

  
</article>
    </main>

    </div>
    
<footer class="footer">
        <span>&copy; 2025 <a href="http://localhost:1313/">Kelvin Nicholson</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
