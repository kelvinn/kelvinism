<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>Gtfs | Kelvin Nicholson</title>
<meta name="keywords" content="">
<meta name="description" content="">
<meta name="author" content="">
<link rel="canonical" href="http://localhost:1313/tags/gtfs/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.9c10de11e12a08317a66b91e7b3785c089446ab2ecdd7fc1503062183a35c4b8.css" integrity="sha256-nBDeEeEqCDF6ZrkeezeFwIlEarLs3X/BUDBiGDo1xLg=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" type="application/rss+xml" href="http://localhost:1313/tags/gtfs/index.xml">
<link rel="alternate" hreflang="en" href="http://localhost:1313/tags/gtfs/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
</head>

<body class="list" id="top">
<div id='redbar'></div>
<div id='greenbar'></div>

<div class="container">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>




<header class="header">
    <a href='/'><span id='logo'></span></a>
    <ul>
        <li><a href='/tags/travel/'>Travel</a></li>
        <li><a href='/tags/longevity/'>Longevity</a></li>
        <li><a href='/tags/projects/'>Projects</a></li>
        <li><a href='/tags/howtos/'>Tutorials</a></li>
        <li><a href='/about/'>Who</a></li>
    </ul>

</header><main class="main"> 

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="post-title entry-hint-parent">
      
      <a aria-label="post link to Sydney Commute Times Mapped Part 2" href="http://localhost:1313/2013/08/sydney-commute-times-mapped-part-2.html">Sydney Commute Times Mapped Part 2 </a>
      
      
    </h2>

    <div class="post-meta"><span title='2013-08-05 07:55:00 +1000 AEST'>Published on August 5, 2013</span>&nbsp;·&nbsp;3 min

</div>
  </header>

  <div class="entry-content">
    <p>In <a href="http://www.kelvinism.com/2013/07/sydney-commute-times-mapped-part-1.html">Sydney Commute Times Mapped Part 1</a> I took a small step to a bigger goal of mashing together public transport in Sydney, and the <a href="http://strategies.planning.nsw.gov.au/Portals/0/Documents/MetroCommunityGuide.pdf">Metropolitan Strategy for Sydney to 2031</a>. The question I wanted to answer is this: how aligned is Sydney&rsquo;s public transport infrastructure and the Metropolitan Strategy&rsquo;s of a &ldquo;city of cities&rdquo;?</p>
<p>I decided to find out.</p>
<p>Thanks to the release of GTFS data by 131500 it is possible to visualise how long it takes via public transport to commute to the nearest &ldquo;centre&rdquo;.</p>
<p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhDc0IriO971A2BQ7F9Nu1zYVZ_uO5OEwv8n0Z9vpPB1IElGYMI0r5bzCah9UCv5fqNzthkaHnPFBN6Pd5PD32GL_xXUJDAYKvXdx3OK8DwtotghU_PDA_Mc_qWYa8gUEKiJxj8Uos4mYbk/s1600/CItyOfCities.png"><img loading="lazy" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhDc0IriO971A2BQ7F9Nu1zYVZ_uO5OEwv8n0Z9vpPB1IElGYMI0r5bzCah9UCv5fqNzthkaHnPFBN6Pd5PD32GL_xXUJDAYKvXdx3OK8DwtotghU_PDA_Mc_qWYa8gUEKiJxj8Uos4mYbk/s1600/CItyOfCities.png"></a></p>
<p>Cities and Corridors - <a href="http://strategies.planning.nsw.gov.au/Portals/0/Documents/MetroCommunityGuide.pdf">Metropolitan Strategy for Sydney to 2031</a></p>
<p>The Australian Bureau of Statistics collects data based on &ldquo;mesh blocks&rdquo;, or roughly an area containing roughly 50 dwellings. Last week I had some fun <a href="http://www.kelvinism.com/2013/07/mapping-mesh-blocks-with-tilemill.html">mapping the mesh blocks</a>, as well as looking at Sydney&rsquo;s <a href="http://www.kelvinism.com/2013/07/mapping-urban-density-in-sydney.html">urban densities</a>. These mesh blocks are a good size to look at for calculating commute times.</p>
<p>The simplified process I used was this, for the technical minded:</p>
<ol>
<li>Calculate the centre of each mesh block</li>
<li>Calculate the commute time via public transport from each block to every &ldquo;centre&rdquo; (using 131500&rsquo;s GTFS and OpenTripPlanner&rsquo;s Analyst tool)</li>
<li>Import times in a database, calculate lowest commute time to each centre</li>
<li>Visualise in TileMill</li>
<li>Serve tiles in TileStache and visualise with Leaflet</li>
</ol>
<p>The first map I created was simply to indicate how long it would take to the nearest centre. There appears to be rapidly poorer accessibility on the fringe of Sydney. I was also surprised of what appears to be a belt of higher times between Wetherill Park and all the way to Marrickville. There also appears to be poorer accessibility in <em>parts</em> of Western Sydney. It is worth noting that I offer not guarantee of the integrity of the data in these maps, and I have seen a few spots where the commute times increase significantly in adjacent mesh blocks. This tells me the street data (from OpenStreetMap) might not be connected correctly.</p>
<p><a href="http://maps.kelvinism.com/syd_city_cities.html">View Full Screen</a></p>
<p>My next map shows what areas are within 30 minutes.</p>
<p><a href="http://maps.kelvinism.com/syd_city_cities_2.html">View Full Screen</a></p>
<p>These maps were both created using open data and open source tools, which I find quite neat. In that spirit, I have exported the database (probably a bit hard for most to work with) to a Shapefile. You can open this in TileMill and experiment, if you wish. Download it from <a href="http://cdn.kelvinism.com/mb_2011_nsw_transport.zip">here</a> (note: 250MB zip file):</p>
<p>I have been interested in mapping traffic for a number of years, maybe ever since arriving in Sydney. It is sort of a hobby; I find making maps relaxing. My first little map was way back in 2008, where I <a href="http://www.kelvinism.com/2008/04/baby-steps-at-graphing-traffic_522.html">visualised speed</a> from a GPS unit. A little later I added <a href="http://www.kelvinism.com/2008/04/another-baby-step_1340.html">some colour to the visualisations</a>, and then used this as an excuse to create a little <a href="http://www.kelvinism.com/2008/05/gui-to-plot-driving-speed_6997.html">GUI for driving speed</a>. My interest in visualising individual vehicles has decreased recently, as it has now shifted to the mapping wider systems. Have an idea you would like to see mapped? Leave a note in the comments.</p>

  </div>

  
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="post-title entry-hint-parent">
      
      <a aria-label="post link to Sydney Commute Times Mapped Part 1" href="http://localhost:1313/2013/07/sydney-commute-times-mapped-part-1.html">Sydney Commute Times Mapped Part 1 </a>
      
      
    </h2>

    <div class="post-meta"><span title='2013-07-21 10:06:00.002 +1000 AEST'>Published on July 21, 2013</span>&nbsp;·&nbsp;2 min

</div>
  </header>

  <div class="entry-content">
    <p>I quite like open data. I like data based on open standards (or mostly open standards) even better. Many transport operators around the world have started releasing their timetable data using (mostly) open standards, e.g. <a href="http://en.wikipedia.org/wiki/General_Transit_Feed_Specification">GTFS</a>. One of the nice things about using a standard is that clever people have created tools to work with the timetable data, and those tools can now be used to manipulate timetable data from hundreds of agencies. The magnificent OpenTripPlanner is one such tool, and it works well with <a href="http://131500.info/">131500</a>&rsquo;s GTFS data.</p>
<p>New South Wales Planning &amp; Infrastructure have released a draft <a href="http://strategies.planning.nsw.gov.au/MetropolitanStrategyforSydney.aspx">plan</a> for how they hope to shape Sydney&rsquo;s growth, which is where they detail the idea of a &ldquo;city of cities&rdquo;. I thought it would be interesting to mash these smaller &ldquo;cities&rdquo; with 131500&rsquo;s transport data, and then display a map with the shortest commute to the nearest city. Various cities, I believe including Melbourne, have goals of re-achieving a &ldquo;20-minute&rdquo; city, or something similar (i.e. X% of the population can reach X% of the city within X minutes).</p>
<p>This map is the first stage. It only displays the commute time to St Leonards from every Mesh Block in the greater Sydney area. I used the open source tool OpenTripPlanner to computer the commute times, with OpenStreetMaps to support walking distances. The next map I release will probably have all the regional cities, and a similar styled map depicting time to nearest &ldquo;centre&rdquo;.</p>
<p><a href="http://maps.kelvinism.com/st_leonards_commute.html">View Full Screen</a></p>

  </div>

  
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="post-title entry-hint-parent">
      
      <a aria-label="post link to How to convert 131500 TDX to GTFS" href="http://localhost:1313/2012/07/how-to-convert-131500-tdx-to-gtfs.html">How to convert 131500 TDX to GTFS </a>
      
      
    </h2>

    <div class="post-meta"><span title='2012-07-02 13:59:00 +1000 AEST'>Published on July 2, 2012</span>&nbsp;·&nbsp;2 min

</div>
  </header>

  <div class="entry-content">
    <p>TDX data has been available for a number of years on 131500.info, but many tools are GTFS specific. I also find GTFS easier to work with.</p>
<p>Luckily, converting from TDX to GTFS is not overly difficult, and below are some instructions. This howto is a bit old, as I am only now copying it from my &ldquo;Notes&rdquo; folder to put online to help others.</p>
<p><strong>Note:</strong> You can now directly download GTFS from the TransportInfo website: <a href="https://tdx.131500.com.au/">https://tdx.131500.com.au</a></p>
<ol>
<li>Signup for an account with EC2 (AWS), unless you have 16GB of memory available on a machine.</li>
<li>Upload <a href="http://code.google.com/p/googletransitdatafeed/">TransXChange2GTFS</a> to a place you can download from.</li>
<li>Upload the latest TDX data dump from 131500.info to a place you can download from.</li>
<li>Login to AWS and start an EC2 instance.  I picked a large instance and used 64-bit Ubuntu 10.04, us-east-1 ami-f8f40591</li>
<li>Download the Data and transxchange to /mnt</li>
</ol>
<pre tabindex="0"><code>wget http://ec2-175-41-139-176.ap-southeast-1.compute.amazonaws.com/Data20110127.zip
wget http://cdn.kelvinism.com/transxchange2GoogleTransit.jar
</code></pre><ol start="6">
<li>Install Sun JRE.</li>
</ol>
<pre tabindex="0"><code>apt-get install python-software-properties
add-apt-repository &#34;deb http://archive.canonical.com/ lucid partner&#34;
apt-get update
apt-get install sun-java6-jre


```7) Check how much memory is available  
</code></pre><p>root@domU-12-31-39-10-31-B1:/mnt# free -m
             total       used       free     shared    buffers     cached
Mem:          7680        626       7053          0         11        329
-/+ buffers/cache:        285       7394
Swap:            0          0          0</p>
<pre tabindex="0"><code>8) Create a configuration file **sydney.conf**  
  
</code></pre><p>url=http://131500.info
timezone=Australia/Sydney
default-route-type=2
output-directory=output
useagencyshortname=true
skipemptyservice=true
skiporhpanstops=true</p>
<pre tabindex="0"><code>9) If you&#39;re on the train like me, start screen, and start converting. The number you pick for &#34;-Xmx&#34; obviously needs to fit in the amount of free memory you have.  
  
</code></pre><p>java -Xmx104000m -jar dist\transxchange2GoogleTransit.jar Data20120524.zip -c sydney.conf</p>
<pre tabindex="0"><code></code></pre>
  </div>

  
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="post-title entry-hint-parent">
      
      <a aria-label="post link to Fusion Tables and 131500 Stops" href="http://localhost:1313/2011/06/fusion-tables-and-131500-stops_465.html">Fusion Tables and 131500 Stops </a>
      
      
    </h2>

    <div class="post-meta"><span title='2011-06-11 20:30:00.002 +1000 AEST'>Published on June 11, 2011</span>&nbsp;·&nbsp;1 min

</div>
  </header>

  <div class="entry-content">
    <p>A short while ago I wrote about <a href="http://www.kelvinism.com/articles/visualizing-transport/">visualizing transport</a> by using 131500&rsquo;s TDX data, converted to GTFS, and served by GeoServer. Because I&rsquo;ve started <a href="http://www.kelvinism.com/travelmap/">playing around</a> with Google&rsquo;s Fusion table, I thought it would be interesting to see what all the transit stops in Sydney look like in FT. So, voila!</p>

  </div>

  
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="post-title entry-hint-parent">
      
      <a aria-label="post link to Converting GTFS to GraphServer" href="http://localhost:1313/2011/06/converting-gtfs-to-graphserver.html">Converting GTFS to GraphServer </a>
      
      
    </h2>

    <div class="post-meta"><span title='2011-06-06 14:07:00 +1000 AEST'>Published on June 6, 2011</span>&nbsp;·&nbsp;1 min

</div>
  </header>

  <div class="entry-content">
    <p>If you want to use Graphserver to do some analysis with GTFS, you will need to convert GTFS into the database. This is how I did it.</p>
<h4 id="get-an-appropriate-ami-from-amazons-ec2">Get an appropriate AMI from Amazon&rsquo;s EC2</h4>
<p>I used the following AMI. If you have enough memory, you don&rsquo;t need to do this.</p>
<pre tabindex="0"><code>ami-7000f019
</code></pre><p>Lookup and read the GTFSDB <a href="http://code.google.com/p/gtfsdb/downloads/detail?name=GTFSDB%20INSTALL.txt">INSTALL.txt</a> document</p>
<h4 id="prepare-system">Prepare system</h4>
<pre tabindex="0"><code>sudo apt-get install mercurial
hg clone https://gtfsdb.googlecode.com/hg/ gtfsdb
sudo apt-get install python-setuptools
sudo easy\_install psycopg2
sudo apt-get install build-essential
</code></pre><h4 id="download-gtfs-database">Download GTFS database</h4>
<pre tabindex="0"><code>ubuntu@domU-12-31-39-00-5D-B8:/mnt/gtfsdb$ pwd
/mnt/gtfsdb
sudo python setup.py install
sudo wget http://cdn.kelvinism.com/google\_transit.zip
sudo apt-get install python-psycopg2
</code></pre><h4 id="prepare-configuration-file">Prepare configuration file</h4>
<pre tabindex="0"><code>#default.cfg
\[options\]
create = True
database = postgresql://nsw:131500@10.128.49.175:5432/nsw
filename = /mnt/google\_transit.zip
geospatial = True
#schema = None
</code></pre><h4 id="perform-import">Perform import</h4>
<pre tabindex="0"><code>screen
python gtfsdb/scripts/load.py
</code></pre>
  </div>

  
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="post-title entry-hint-parent">
      
      <a aria-label="post link to Visualizing Transport" href="http://localhost:1313/2011/04/visualizing-transport_1492.html">Visualizing Transport </a>
      
      
    </h2>

    <div class="post-meta"><span title='2011-04-03 20:30:00.003 +1000 AEST'>Published on April 3, 2011</span>&nbsp;·&nbsp;2 min

</div>
  </header>

  <div class="entry-content">
    <p>I&rsquo;ve had several conversations with neighbors and co-workers about the &ldquo;lack&rdquo; of forward thinking, or at least the lack of forward action. Of course, I keep in the back of my mind that we aren&rsquo;t &ldquo;experts&rdquo;, and the more I learn about transport the more I learn how complex it is. Dr. Sussman&rsquo;s <em>CLIOS</em> process (Complex, Large-<br>
Scale, Integrated, Open Systems) appears more and more true the longer I work in and study transport. There is a plethora of excuses that can be made, but the general conclusion was that the earlier we prepare the better. I can remember working near Zhongshan 7-8 years ago and driving around on huge roads in the middle of empty fields. There weren&rsquo;t even stoplights at every intersection. It was then that I had an epiphany of how smart the planning was to build the infrastructure <em>before</em> the masses arrived.</p>
<p>Sydney is estimated to increase by some 1.7 million people by 2036, and I can tell you, from a transportation (private and public) standpoint, that sort of scares me. When people ask me why transport is so difficult I justify it by with my uneducated guess that the CBD is next to the ocean, so everybody travels in from just 180 degrees instead of 360. Maybe this is why the NSW government created the &ldquo;<a href="http://www.metrostrategy.nsw.gov.au/TheStrategy/tabid/38/language/en-US/Default.aspx">City of Cities</a>&rdquo; strategy. I realized this within the first few weeks: most people live west but work east.</p>
<p>Tonight (a Saturday) I was bored, and should have been studying, but wanted to create a few visualizations first.</p>
<p>The below maps were created using TDX data released from 131500. After converting it to GTFS I imported it into PostGIS using GTFSDB, and then could serve it via GeoServer. Finally, I could access it via WMS in QGIS. I added the stops into a map of Sydney and added some boundaries, and added the Growth Zones. The result was a map with every bus/train/ferry stop. Darker areas have stops that are closer (not necessarily more frequent service).</p>
<p><a href="https://picasaweb.google.com/lh/photo/OFVoJjgA8rE7DnDEn-5s8g?feat=embedwebsite"><img loading="lazy" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhkt_ncrwpoO0aHDkgFihoyvgu9rtIcFwlzQzteTjYbpmXDxHnOB4iLmDdKQOcDXxKSJ8qeNrEHbm_Pa_5RNvLmLKlmNCrtQLGb5Q-_KKcIuyE9t-7UMPZx20cA3vdnprQLo4zKQCIwndyi/s400/Screenshot-4.png"></a></p>
<p><a href="https://picasaweb.google.com/lh/photo/GOEcSQyVq9ExTJdIYzTF0Q?feat=embedwebsite"><img loading="lazy" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjMg3aEJToq5P2XQm2Yq4550mzTi6q9AsSv7dPaeqSyNahlZ01lRpglbMnC7s6_f8XDD1Sewna-aFKq_QwO2Zl4FRkrggnMeRlS87go9qFmJhKYMHyIVvr7tl1Zx0NQ8lKV_DTeLOUota8z/s400/growtharea.png"></a></p>
<p><a href="https://picasaweb.google.com/lh/photo/Yp2Z2tpQ2OKGKs52WAJkiw?feat=embedwebsite"><img loading="lazy" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhy_Fbqf9siL_AND2UfnYRLbG2UGqb64rSWXBZrTKRGBjBw8rj3IV9_AQqYs0b_kc5ohyqxAuBoFq-sTYspWPgIagbRELFe995VnWuvmlt01aXUirynovd2hCwC6Zom31z6Pyvpabl13N0I/s400/growtharea2.png"></a></p>
<p>One of the first things I noticed is that there isn&rsquo;t much physical infrastructure in these areas. There also aren&rsquo;t many transit stops; I suppose this is why the <a href="http://en.wikipedia.org/wiki/South_West_railway_line,_Sydney">South West Rail Link</a> is going to be so important. I don&rsquo;t know all of the political ramifications, but let&rsquo;s hope the <a href="http://en.wikipedia.org/wiki/Proposed_railways_in_Sydney#North_West_Rail_Link_.28NWRL.29">North West Rail Link</a> is built as well?</p>

  </div>

  
</article>
    </main>

    </div>
    
<footer class="footer">
        <span>&copy; 2025 <a href="http://localhost:1313/">Kelvin Nicholson</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
